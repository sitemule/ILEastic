  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   DEMO03
     Library  . . . . . . . . . . . :     ILEASTIC
   Text 'description' . . . . . . . :   *SRCMBRTXT
   Source stream file   . . . . . . :   demo03.rpgle
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   06-09-18  02:42:17
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *UNREF     *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
                                    :   /prj/noxdb
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1    // -----------------------------------------------------------------------------                                  000001
      2    // This example runs a simple servlet using ILEastic framework                                                    000002
      3    // Note: It requires your RPG code to be reentrant and compiled                                                   000003
      4    // for multithreading. Each client request is handled by a seperate thread.                                       000004
      5    // Start it:                                                                                                      000005
      6    // SBMJOB CMD(CALL PGM(DEMO03)) JOB(ILEASTIC3) JOBQ(QSYSNOMAX) ALWMLTTHD(*YES)                                    000006
      7    // -----------------------------------------------------------------------------                                  000007
      8    ctl-opt copyright('Sitemule.com (C), 2018');                                                                      000008
      9    ctl-opt decEdit('0,') datEdit(*YMD.) main(main);                                                                  000009
     10    ctl-opt debug(*yes) bndDir('ILEASTIC':'NOXDB');                                                                   000010
     11    ctl-opt thread(*CONCURRENT);                                                                                      000011
     12                                                                                                                      000012
     13    /include ./headers/ILEastic.rpgle                                                                                 000013
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  ILEastic.+                                                   *                     1
         * External name  . . . . . . :  ./.././headers/ILEastic.rpgle                                *                     1
         * Last change  . . . . . . . :  06-09-18  00:41:25                                           *                     1
         *--------------------------------------------------------------------------------------------*
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *NOSRCSTMT        *
         *                                       *DEBUGIO   *UNREF            *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   ILEASTIC     NOXDB           *
         *    Library  . . . . . . . . . . . :     *LIBL        *LIBL         *
         *  Activation group . . . . . . . . :   *STGMDL                      *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
     14+   dcl-ds  LVARPUCHARDS  qualified based(prototype_only);                                                           1000001
     15+       Length  int(10);                                                                                             1000002
     16+       String  pointer;                                                                                             1000003
     17+   end-ds;                                                                                                          1000004
     18+                                                                                                                    1000005
     19+   dcl-ds  configDS qualified based(prototype_only);                                                                1000006
     20+       host    varchar(64);                                                                                         1000007
     21+       port    int(10);                                                                                             1000008
     22+       filler  char(4096);                                                                                          1000009
     23+   end-ds;                                                                                                          1000010
     24+                                                                                                                    1000011
     25+   dcl-ds requestDS qualified based(prototype_only);                                                                1000012
     26+       pConfig        pointer;                                                                                      1000013
     27+       method         likeds(LVARPUCHARDS);                                                                         1000014
     28+       url            likeds(LVARPUCHARDS);                                                                         1000015
     29+       resource       likeds(LVARPUCHARDS);                                                                         1000016
     30+       queryString    likeds(LVARPUCHARDS);                                                                         1000017
     31+       protocol       likeds(LVARPUCHARDS);                                                                         1000018
     32+       headers        likeds(LVARPUCHARDS);                                                                         1000019
     33+       content        likeds(LVARPUCHARDS);                                                                         1000020
     34+       contentType    varchar(256);                                                                                 1000021
     35+       completeHeader likeds(LVARPUCHARDS);                                                                         1000022
     36+   end-ds;                                                                                                          1000023
     37+                                                                                                                    1000024
     38+   dcl-ds responseDS qualified based(prototype_only);                                                               1000025
     39+       pConfig     pointer;                                                                                         1000026
     40+       status      int(5);                                                                                          1000027
     41+       statusText  varchar(256);                                                                                    1000028
     42+       contentType varchar(256);                                                                                    1000029
     43+       charset     varchar(32) ;                                                                                    1000030
     44+   end-ds;                                                                                                          1000031
     45+                                                                                                                    1000032
     46+   dcl-pr lCopy    varchar(524284:4) ccsid(*utf8) rtnparm                                                           1000033
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     47+                   extproc(*CWIDEN:'lvpc2lvc');                                                                     1000034
     48+       input       likeds(LVARPUCHARDS);                                                                            1000035
     49+   end-pr;                                                                                                          1000036
     50+                                                                                                                    1000037
     51+                                                                                                                    1000038
     52+   dcl-pr il_getRequestMethod  varchar(256:2) ccsid(*utf8) rtnparm                                                  1000039
     53+                   extproc(*CWIDEN:'il_getRequestMethod');                                                          1000040
     54+       pRequest likeds(RequestDS);                                                                                  1000041
     55+   end-pr;                                                                                                          1000042
     56+                                                                                                                    1000043
     57+   dcl-pr il_getRequestUrl  varchar(524284:4) ccsid(*utf8) rtnparm                                                  1000044
     58+                   extproc(*CWIDEN:'il_getRequestUrl');                                                             1000045
     59+       pRequest likeds(RequestDS);                                                                                  1000046
     60+   end-pr;                                                                                                          1000047
     61+                                                                                                                    1000048
     62+   dcl-pr il_getRequestResource  varchar(524284:4) ccsid(*utf8) rtnparm                                             1000049
     63+                   extproc(*CWIDEN:'il_getRequestResource');                                                        1000050
     64+       pRequest likeds(RequestDS);                                                                                  1000051
     65+   end-pr;                                                                                                          1000052
     66+                                                                                                                    1000053
     67+   dcl-pr il_getRequestQueryString  varchar(524284:4) ccsid(*utf8) rtnparm                                          1000054
     68+                   extproc(*CWIDEN:'il_getRequestQueryString');                                                     1000055
     69+       pRequest likeds(RequestDS);                                                                                  1000056
     70+   end-pr;                                                                                                          1000057
     71+                                                                                                                    1000058
     72+   dcl-pr il_getRequestProtocol  varchar(256:2)  ccsid(*utf8) rtnparm                                               1000059
     73+                   extproc(*CWIDEN:'il_getRequestProtocol');                                                        1000060
     74+       pRequest likeds(RequestDS);                                                                                  1000061
     75+   end-pr;                                                                                                          1000062
     76+                                                                                                                    1000063
     77+   dcl-pr il_getRequestHeaders  varchar(524284:4)  ccsid(*utf8) rtnparm                                             1000064
     78+                   extproc(*CWIDEN:'il_getRequestHeaders');                                                         1000065
     79+       pRequest likeds(RequestDS);                                                                                  1000066
     80+   end-pr;                                                                                                          1000067
     81+                                                                                                                    1000068
     82+                                                                                                                    1000069
     83+   dcl-pr il_getFileMimeType  varchar(256:2)  rtnparm                                                               1000070
     84+                   extproc(*CWIDEN:'il_getFileMimeType');                                                           1000071
     85+       fileName    varchar(256:2);                                                                                  1000072
     86+   end-pr;                                                                                                          1000073
     87+                                                                                                                    1000074
     88+   dcl-pr il_getFileExtension  varchar(256:2)  rtnparm                                                              1000075
     89+                   extproc(*CWIDEN:'il_getFileExtension');                                                          1000076
     90+       fileName    varchar(256:2);                                                                                  1000077
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     91+   end-pr;                                                                                                          1000078
     92+                                                                                                                    1000079
     93+   dcl-pr il_listen extproc(*CWIDEN:'il_listen');                                                                   1000080
     94+       pConfig     likeds(configDS);                                                                                1000081
     95+       pServlet    pointer(*PROC) value;                                                                            1000082
     96+   end-pr;                                                                                                          1000083
     97+                                                                                                                    1000084
     98+   dcl-pr il_responseWrite extproc(*CWIDEN:'il_responseWrite');                                                     1000085
     99+       pResponse   likeds(responseDS);                                                                              1000086
    100+       buf         varchar(524284:4) ccsid(*utf8) options(*varsize) const ;                                         1000087
    101+   end-pr;                                                                                                          1000088
    102+                                                                                                                    1000089
    103+   dcl-pr il_responseWriteBin extproc(*CWIDEN:'il_responseWrite');                                                  1000090
    104+       pResponse   likeds(responseDS);                                                                              1000091
    105+       buf         varchar(524284:4) options(*varsize) const ;                                                      1000092
    106+   end-pr;                                                                                                          1000093
    107+                                                                                                                    1000094
    108+   dcl-pr il_serveStatic ind extproc(*CWIDEN:'il_serveStatic');                                                     1000095
    109+       pResponse   likeds(responseDS);                                                                              1000096
    110+       fileName    varchar(256) options(*varsize) const;                                                            1000097
    111+   end-pr;                                                                                                          1000098
    112+                                                                                                                    1000099
    113+   dcl-pr il_responseWriteStream extproc(*CWIDEN:'il_responseWriteStream');                                         1000100
    114+       pResponse   likeds(responseDS);                                                                              1000101
    115+       pStream     pointer value;                                                                                   1000102
    116+   end-pr;                                                                                                          1000103
    117+                                                                                                                    1000104
    118    /include ./headers/JSONparser.rpgle                                                                               000014
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  JSONparse+                                                   *                     2
         * External name  . . . . . . :  /prj/noxdb/./headers/JSONparser.rpgle                        *                     2
         * Last change  . . . . . . . :  06-09-18  01:28:02                                           *                     2
         *--------------------------------------------------------------------------------------------*
    119+   //---------------------------------------------------------------------- *                                       2000001
    120+   //This is the prototype for BlueSeries/IceBreak - JSON and XML parser                                            2000002
    121+   //Use the JSONXML binddir when creating your program and include this                                            2000003
    122+   //prototypes like:                                                                                               2000004
    123+                                                                                                                    2000005
    124+   //H BNDDIR('JSONPARSER')                                                                                         2000006
    125+   ///include jsonParser                                                                                            2000007
    126+                                                                                                                    2000008
    127+   //Or                                                                                                             2000009
    128+                                                                                                                    2000010
    129+   //H BNDDIR('XMLPARSER')                                                                                          2000011
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    130+   ///include xmlParser                                                                                             2000012
    131+                                                                                                                    2000013
    132+   //Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                             2000014
    133+   //the JSONXML header. so please do not make any changes th there headerfi                                        2000015
    134+                                                                                                                    2000016
    135+   //Note: all binddirectories JSONPARSER, XMLPARSER and JSONXML is the same                                        2000017
    136+   //---------------------------------------------------------------------- *                                       2000018
    137+ /if defined( json_DEF)                                                                                             2000019
             LINES EXCLUDED: 1
    138+ /endif                                                                                                             2000021
    139+ /define  json_DEF                                                                                                  2000022
    140+   //---------------------------------------------------------------------- *                                       2000023
    141+   //Before starting that parser - to enshure right enterpretations of delimi                                       2000024
    142+   //Usage:                                                                                                         2000025
    143+   //jx_setDelimiters( json_DELIMITERS);                                                                            2000026
    144+   //--------------------------------------------------------------------- *                                        2000027
    145+   //get delimiter pointer                                                                                          2000028
    146+   Dcl-PR json_getDelimiters Pointer extproc(*CWIDEN :'jx_GetDelimiters');                                          2000029
    147+   End-PR;                                                                                                          2000030
    148+   //Set delimiter used for locate expression                                                                       2000031
    149+   Dcl-PR json_setDelimiters  extproc(*CWIDEN :'jx_SetDelimiters2');                                                2000032
    150+     //always: '/\Ø#¤ .æå' in your  local CCSID                                                                     2000033
    151+     delimiterStr   Pointer    value options(*string);                                              I               2000034
    152+   End-PR;                                                                                                          2000035
    153+                                                                                                                    2000036
    154+   Dcl-C json_DELIMITERS const('/\Ø#¤ .æå''"');                                                                     2000037
    155+                                                                                                                    2000038
    156+   //---------------------------------------------------------------------- *                                       2000039
    157+   //Type of a node:                                                                                                2000040
    158+   //---------------------------------------------------------------------- *                                       2000041
    159+   Dcl-C json_UNKNOWN const(0);                                                                                     2000042
    160+   Dcl-C json_OBJECT  const(1);                                                                                     2000043
    161+   Dcl-C json_ARRAY   const(2);                                                                                     2000044
    162+   Dcl-C json_EVAL    const(3);                                                                                     2000045
    163+   Dcl-C json_POINTER_VALUE const(4);                                                                               2000046
    164+   Dcl-C json_VALUE   const(5);                                                                                     2000047
    165+   Dcl-C json_ROOT    const(6);                                                                                     2000048
    166+   Dcl-C json_LITERAL const(16);                                                                                    2000049
    167+   Dcl-C json_OBJLINK const(17);                                                                                    2000050
    168+   Dcl-C json_OBJREPLACE const(18);                                                                                 2000051
    169+   Dcl-C json_OBJCOPY const(18);                                                                                    2000052
    170+   Dcl-C json_BY_CONTEXT const(19);                                                                                 2000053
    171+   Dcl-C json_OBJMOVE const(2048);                                                                                  2000054
    172+                                                                                                                    2000055
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    173+   //* Modifiers to "add" / "or" into "parseString" and "evaluate"                                                  2000056
    174+   //!! Type - have to be backwards compat.                                                                         2000057
    175+   //Unlink the source and move it to dest.                                                                         2000058
    176+   Dcl-C json_MOVE_MODES const(2048);                                                                               2000059
    177+   //Allow strings ints and other values to                                                                         2000060
    178+   Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                         2000061
    179+                                                                                                                    2000062
    180+   //* Combinations:                                                                                                2000063
    181+   //JX_PARSE  = json_EVAL + json_MOVE_NODES                                                                        2000064
    182+   Dcl-C json_PARSE   const(2051);                                                                                  2000065
    183+                                                                                                                    2000066
    184+   //Merge options:                                                                                                 2000067
    185+   //Modifiers to "add" / "or" into "JSON_EVAL"                                                                     2000068
    186+ /if not defined(MO_MERGE)                                                                                          2000069
    187+ /define  MO_MERGE                                                                                                  2000070
    188+   //Only new elements are merged - existing                                                                        2000071
    189+   //are left untouched                                                                                             2000072
    190+   Dcl-C MO_MERGE_NEW const(256);                                                                                   2000073
    191+   //Merge and replace only existing nodes.                                                                         2000074
    192+   Dcl-C MO_MERGE_MATCH const(512);                                                                                 2000075
    193+   //Merge all: replace if it exists and                                                                            2000076
    194+   //append new nodes if not exists                                                                                 2000077
    195+   Dcl-C MO_MERGE_REPLACE const(1024 );                                                                             2000078
    196+ /endif                                                                                                             2000079
    197+                                                                                                                    2000080
    198+   Dcl-C json_CHILD_LIST const('#0¤');                                                                              2000081
    199+                                                                                                                    2000082
    200+   //---------------------------------------------------------------------- *                                       2000083
    201+   //Returns node to the json_object tree                                                                           2000084
    202+   Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'jx_ParseFile');                                   I               2000085
    203+     //File to parse                                                                                                2000086
    204+     FileName       Pointer    value options(*string);                                              I               2000087
    205+     //Parsing options                                                                                              2000088
    206+     Options        Pointer    value options(*string:*nopass);                                      I               2000089
    207+   End-PR;                                                                                                          2000090
    208+                                                                                                                    2000091
    209+   //Returns node json_object tree                                                                                  2000092
    210+   Dcl-PR json_ParseString Pointer extproc(*CWIDEN:'jx_ParseString');                               I               2000093
    211+     //String to parse                                                                                              2000094
    212+     String         Pointer    value options(*string);                                              I               2000095
    213+     //Parsing options                                                                                              2000096
    214+     Options        Pointer    value options(*string:*nopass);                                      I               2000097
    215+   End-PR;                                                                                                          2000098
    216+                                                                                                                    2000099
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    217+   //Set , or . for numeri decimal point                                                                            2000100
    218+   Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'jx_SetDecPoint');                                                    2000101
    219+     //decimal point char                                                                                           2000102
    220+     decPoint       Pointer    value options(*string);                                                              2000103
    221+   End-PR;                                                                                                          2000104
    222+                                                                                                                    2000105
    223+                                                                                                                    2000106
    224+                                                                                                                    2000107
    225+   //Bool true if errors occures                                                                                    2000108
    226+   Dcl-PR json_Error Ind extproc(*CWIDEN:'jx_Error');                                               I               2000109
    227+     //jx_Object  node                                                                                              2000110
    228+     pNode          Pointer    value;                                                               I               2000111
    229+   End-PR;                                                                                                          2000112
    230+                                                                                                                    2000113
    231+   //Return error description                                                                                       2000114
    232+   Dcl-PR json_Message Varchar(1024) extproc(*CWIDEN:'jx_Message');                                 I               2000115
    233+     //jx_Object                                                                                                    2000116
    234+     pNode          Pointer    value;                                                               I               2000117
    235+   End-PR;                                                                                                          2000118
    236+                                                                                                                    2000119
    237+   //Returns pointer to node                                                                                        2000120
    238+   Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'jx_GetNode');                                      I               2000121
    239+     //Pointer to tree or node                                                                                      2000122
    240+     pNode          Pointer    value;                                                               I               2000123
    241+     //location expression                                                                                          2000124
    242+     Expression     Pointer    value options(*string);                                              I               2000125
    243+   End-PR;                                                                                                          2000126
    244+                                                                                                                    2000127
    245+   //Returns pointer to node                                                                                        2000128
    246+   Dcl-PR json_LocateOrCreate Pointer                                                               I               2000129
    247+                            extproc(*CWIDEN : 'jx_GetOrCreateNode');                                                2000130
    248+     //Pointer to tree or node                                                                                      2000131
    249+     pNode          Pointer    value;                                                               I               2000132
    250+     //location expression                                                                                          2000133
    251+     Expression     Pointer    value options(*string);                                              I               2000134
    252+   End-PR;                                                                                                          2000135
    253+                                                                                                                    2000136
    254+   //Returns 'ON' if node exists                                                                                    2000137
    255+   Dcl-PR json_Has Ind extproc(*CWIDEN : 'jx_Has');                                                 I               2000138
    256+     //Pointer to tree or node                                                                                      2000139
    257+     pNode          Pointer    value;                                                               I               2000140
    258+     //Path to node                                                                                                 2000141
    259+     NodeName       Pointer    value options(*string);                                              I               2000142
    260+   End-PR;                                                                                                          2000143
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    261+                                                                                                                    2000144
    262+   //Returns 'ON' if node exists and has <> 0                                                                       2000145
    263+   Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'jx_IsTrue');                                           I               2000146
    264+     //Pointer to tree or node                                                                                      2000147
    265+     pNode          Pointer    value;                                                               I               2000148
    266+     //Path to node                                                                                                 2000149
    267+     NodeName       Pointer    value options(*string);                                              I               2000150
    268+   End-PR;                                                                                                          2000151
    269+                                                                                                                    2000152
    270+   //Returns 'ON' if node exists and has <> 0                                                                       2000153
    271+   Dcl-PR json_isNull Ind extproc(*CWIDEN : 'jx_IsNull');                                           I               2000154
    272+     //Pointer to tree or node                                                                                      2000155
    273+     pNode          Pointer    value;                                                               I               2000156
    274+     //Path to node                                                                                                 2000157
    275+     NodeName       Pointer    value options(*string);                                              I               2000158
    276+   End-PR;                                                                                                          2000159
    277+                                                                                                                    2000160
    278+   //Returns 'ON' if it is a valid node                                                                             2000161
    279+   Dcl-PR json_isNode Ind extproc(*CWIDEN : 'jx_isNode');                                           I               2000162
    280+     //a.k.a. false for strings                                                                                     2000163
    281+     pNode          Pointer    value;                                                               I               2000164
    282+   End-PR;                                                                                                          2000165
    283+                                                                                                                    2000166
    284+   //renames the node name                                                                                          2000167
    285+   Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'jx_NodeRename');                                   I               2000168
    286+     //Pointer to tree or node                                                                                      2000169
    287+     pNode          Pointer    value;                                                               I               2000170
    288+     //Path to node                                                                                                 2000171
    289+     NodeName       Pointer    value options(*string);                                              I               2000172
    290+   End-PR;                                                                                                          2000173
    291+                                                                                                                    2000174
    292+   //Returns pointer to next sibling (elem)                                                                         2000175
    293+   Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                 I               2000176
    294+     //Pointer to current node (elem)                                                                               2000177
    295+     pNode          Pointer    value;                                                               I               2000178
    296+   End-PR;                                                                                                          2000179
    297+                                                                                                                    2000180
    298+   //Returns pointer to first child (elem)                                                                          2000181
    299+   Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                               I               2000182
    300+     //Pointer to current node (elem)                                                                               2000183
    301+     pNode          Pointer    value;                                                               I               2000184
    302+   End-PR;                                                                                                          2000185
    303+                                                                                                                    2000186
    304+   //Returns pointer to parent node                                                                                 2000187
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    305+   Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'jx_GetNodeParent');                             I               2000188
    306+     //Pointer to current node (elem)                                                                               2000189
    307+     pNode          Pointer    value;                                                               I               2000190
    308+   End-PR;                                                                                                          2000191
    309+                                                                                                                    2000192
    310+   Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'jx_SetStrByName');                                                  2000193
    311+     //Pointer to json_ tree                                                                                        2000194
    312+     pNode          Pointer    value;                                                                               2000195
    313+     //X-path locations to node or attributes                                                                       2000196
    314+     Expresion      Pointer    value options(*string);                                                              2000197
    315+     //New value to set / pointer to object                                                                         2000198
    316+     Value          Pointer    value options(*string);                                                              2000199
    317+   End-PR;                                                                                                          2000200
    318+                                                                                                                    2000201
    319+   Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'jx_SetIntByName');                                                  2000202
    320+     //Pointer to json_ tree                                                                                        2000203
    321+     pNode          Pointer    value;                                                                               2000204
    322+     //X-path locations to node or attributes                                                                       2000205
    323+     Expresion      Pointer    value options(*string);                                                              2000206
    324+     //New value to set / pointer to object                                                                         2000207
    325+     Value          Int(10)    value;                                                                               2000208
    326+   End-PR;                                                                                                          2000209
    327+                                                                                                                    2000210
    328+   Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  2000211
    329+     //Pointer to json_ tree                                                                                        2000212
    330+     pNode          Pointer    value;                                                                               2000213
    331+     //X-path locations to node or attributes                                                                       2000214
    332+     Expresion      Pointer    value options(*string);                                                              2000215
    333+     //New value to set / pointer to object                                                                         2000216
    334+     Value          Packed(30:15) value;                                                                            2000217
    335+   End-PR;                                                                                                          2000218
    336+                                                                                                                    2000219
    337+   Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'jx_SetBoolByName');                                                2000220
    338+     //Pointer to json_ tree                                                                                        2000221
    339+     pNode          Pointer    value;                                                                               2000222
    340+     //X-path locations to node or attributes                                                                       2000223
    341+     Expresion      Pointer    value options(*string);                                                              2000224
    342+     //New value to set / pointer to object                                                                         2000225
    343+     Value          Ind        value;                                                                               2000226
    344+   End-PR;                                                                                                          2000227
    345+                                                                                                                    2000228
    346+   Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                                  2000229
    347+     //Pointer to json_ tree                                                                                        2000230
    348+     pNode          Pointer    value;                                                                               2000231
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    349+     //X-path locations to node or attributes                                                                       2000232
    350+     Expresion      Pointer    value options(*string);                                                              2000233
    351+     //Pointer to anything - You do the cleanup                                                                     2000234
    352+     Value          Pointer    value;                                                                               2000235
    353+   End-PR;                                                                                                          2000236
    354+                                                                                                                    2000237
    355+   Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'jx_SetValueByName');                                              2000238
    356+     //Pointer to json_ tree                                                                                        2000239
    357+     pNode          Pointer    value;                                                                               2000240
    358+     //X-path locations to node or attributes                                                                       2000241
    359+     Expresion      Pointer    value options(*string);                                                              2000242
    360+     //New value to set / pointer to object                                                                         2000243
    361+     Value          Pointer    value options(*string:*nopass);                                                      2000244
    362+     //Optional new type (Refer "node type"                                                                         2000245
    363+     Type           Uns(5)     value options(*nopass);                                                              2000246
    364+   End-PR;                                                                                                          2000247
    365+                                                                                                                    2000248
    366+   Dcl-PR json_GetValueStr Varchar(32767)                                                           I               2000249
    367+                         extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                    2000250
    368+     //Pointer to node                                                                                              2000251
    369+     pNode          Pointer    value;                                                               I               2000252
    370+     //If not found - default value                                                                                 2000253
    371+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000254
    372+   End-PR;                                                                                                          2000255
    373+                                                                                                                    2000256
    374+   Dcl-PR json_GetValueNum Packed(30:15)                                                            I               2000257
    375+                         extproc(*CWIDEN : 'jx_GetNodeValueNum');                                                   2000258
    376+     //Pointer to node                                                                                              2000259
    377+     pNode          Pointer    value;                                                               I               2000260
    378+     //If not found - default value                                                                                 2000261
    379+     Defaultvalue   Packed(30:15) value options(*NOPASS);                                           I               2000262
    380+   End-PR;                                                                                                          2000263
    381+                                                                                                                    2000264
    382+   Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'jx_GetNodeValuePtr');                         I               2000265
    383+     //Pointer to node                                                                                              2000266
    384+     pNode          Pointer    value;                                                               I               2000267
    385+     //If not found - default value                                                                                 2000268
    386+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000269
    387+   End-PR;                                                                                                          2000270
    388+                                                                                                                    2000271
    389+   Dcl-PR json_GetName Varchar(32767)                                                               I               2000272
    390+                     extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                         2000273
    391+     //Pointer to node                                                                                              2000274
    392+     pNode          Pointer    value;                                                               I               2000275
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    393+   End-PR;                                                                                                          2000276
    394+                                                                                                                    2000277
    395+   Dcl-PR json_GetNameAsPath Varchar(32767)                                                         I               2000278
    396+                           extproc(*CWIDEN : 'jx_GetNodeNameAsPath');                                               2000279
    397+     //Pointer to node                                                                                              2000280
    398+     pNode          Pointer    value;                                                               I               2000281
    399+     //Delimiter like - or . or / or \                                                                              2000282
    400+     Delimiter      Char(1)    value;                                                               I               2000283
    401+   End-PR;                                                                                                          2000284
    402+                                                                                                                    2000285
    403+   //* Refer to node type above                                                                                     2000286
    404+   Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                 I               2000287
    405+     //Pointer to json_ tree to receive format                                                                      2000288
    406+     pNode          Pointer    value;                                                               I               2000289
    407+   End-PR;                                                                                                          2000290
    408+                                                                                                                    2000291
    409+ // Get string by expresion                                                                                         2000292
    410+ //  /object/array#123¤/name                                                                                        2000293
    411+ //  .object.array#123¤.name                                                                                        2000294
    412+   Dcl-PR json_GetStr Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                            2000295
    413+     //Pointer to relative node                                                                                     2000296
    414+     pNode          Pointer    value;                                                                               2000297
    415+     //Locations expression to node                                                                                 2000298
    416+     Expression     Pointer    value options(*string:*nopass);                                                      2000299
    417+     //If not found - default value                                                                                 2000300
    418+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      2000301
    419+   End-PR;                                                                                                          2000302
    420+                                                                                                                    2000303
    421+ //  will join all subsequent array nodes into one resulting string                                                 2000304
    422+   Dcl-PR json_GetStrJoin Varchar(32767)                                                                            2000305
    423+                        extproc(*CWIDEN : 'jx_GetStrJoinVC');                                                       2000306
    424+     //Pointer to relative node                                                                                     2000307
    425+     pNode          Pointer    value;                                                                               2000308
    426+     //Locations expression to node                                                                                 2000309
    427+     Expression     Pointer    value options(*string:*nopass);                                                      2000310
    428+     //If not found - default value                                                                                 2000311
    429+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      2000312
    430+   End-PR;                                                                                                          2000313
    431+                                                                                                                    2000314
    432+ // Get number by expresion like:                                                                                   2000315
    433+ //  /object/array#123¤/name                                                                                        2000316
    434+ //  .object.array#123¤.name                                                                                        2000317
    435+   Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'jx_GetValueNum');                                            2000318
    436+     //Pointer to relative node                                                                                     2000319
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    437+     pNode          Pointer    value;                                                                               2000320
    438+     //Locations expression to node                                                                                 2000321
    439+     Expression     Pointer    value options(*string:*nopass);                                                      2000322
    440+     //If not found - default value                                                                                 2000323
    441+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           2000324
    442+   End-PR;                                                                                                          2000325
    443+                                                                                                                    2000326
    444+   //Set an ILOB object to a value found by X                                                       I               2000327
    445+   //Return *ON if found                                                                                            2000328
    446+   Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                               I               2000329
    447+     //Pointer to ILOB object to receive the va                                                                     2000330
    448+     pIlob          Pointer    value;                                                               I               2000331
    449+     //Pointer to tree                                                                                              2000332
    450+     pNode          Pointer    value;                                                               I               2000333
    451+     //X-path locations to node or attributes                                                                       2000334
    452+     Expression     Pointer    value options(*string);                                              I               2000335
    453+   End-PR;                                                                                                          2000336
    454+                                                                                                                    2000337
    455+   Dcl-PR json_NodeCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                           2000338
    456+     //node. Retrive from Locate()                                                                                  2000339
    457+     pRootNode      Pointer    value;                                                                               2000340
    458+     //node. Retrive from Locate()                                                                                  2000341
    459+     pNewChild      Pointer    value;                                                                               2000342
    460+     //Reference location to where it arrive                                                                        2000343
    461+     RefLocation    Int(10)    value;                                                                               2000344
    462+   End-PR;                                                                                                          2000345
    463+                                                                                                                    2000346
    464+   //Following constants used by json_NodeCopy:RefLocation                                                          2000347
    465+   Dcl-C json_FIRST_CHILD const(1);                                                                                 2000348
    466+   Dcl-C json_LAST_CHILD const(2);                                                                                  2000349
    467+   Dcl-C json_BEFORE_SIBLING const(3);                                                                              2000350
    468+   Dcl-C json_AFTER_SIBLING const(4);                                                                               2000351
    469+                                                                                                                    2000352
    470+   Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'jx_NodeClone');                                                 2000353
    471+     //node. Retrive from Locate()                                                                                  2000354
    472+     pSource        Pointer    value;                                                                               2000355
    473+   End-PR;                                                                                                          2000356
    474+                                                                                                                    2000357
    475+   //returns the new node                                                                                           2000358
    476+   Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                     2000359
    477+     //node. Retrive from Locate()                                                                                  2000360
    478+     pRootNode      Pointer    value;                                                                               2000361
    479+     //Reference location to where it arrive                                                                        2000362
    480+     RefLocation    Int(10)    value;                                                                               2000363
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    481+     //Name of node                                                                                                 2000364
    482+     Name           Pointer    value options(*string);                                              I               2000365
    483+     //Value or expression                                                                                          2000366
    484+     Value          Pointer    value options(*string);                                              I               2000367
    485+     //New type (Refer "node type"                                                                                  2000368
    486+     Type           Uns(5)     value;                                                                               2000369
    487+   End-PR;                                                                                                          2000370
    488+                                                                                                                    2000371
    489+   Dcl-PR json_NodeDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                       2000372
    490+     //node. Retrive from Locate()                                                                                  2000373
    491+     pRootNode      Pointer    value;                                                                               2000374
    492+   End-PR;                                                                                                          2000375
    493+                                                                                                                    2000376
    494+   Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'jx_NodeSanitize');                                                   2000377
    495+     //node. Retrive from Locate()                                                                                  2000378
    496+     pRootNode      Pointer    value;                                                                               2000379
    497+   End-PR;                                                                                                          2000380
    498+                                                                                                                    2000381
    499+   //returns the new node                                                                                           2000382
    500+   Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'jx_NewObject');                                                 2000383
    501+     //Destination. Retrive from Locate()                                                                           2000384
    502+     pDestNode      Pointer    value options(*nopass);                                                              2000385
    503+   End-PR;                                                                                                          2000386
    504+                                                                                                                    2000387
    505+ // Array functions                                                                                                 2000388
    506+   //returns the new node                                                                                           2000389
    507+   Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'jx_NewArray');                                                   2000390
    508+     //Destination. Retrive from Locate()                                                                           2000391
    509+     pDestNode      Pointer    value options(*nopass);                                                              2000392
    510+   End-PR;                                                                                                          2000393
    511+                                                                                                                    2000394
    512+   //returns the new node added to the end of                                                                       2000395
    513+   Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'jx_ArrayPush');                                                 2000396
    514+     //Destination. Retrive from Locate()                                                                           2000397
    515+     pDestArray     Pointer    value;                                                                               2000398
    516+     //source node to append                                                                                        2000399
    517+     pSourceNode    Pointer    value options(*string);                                                              2000400
    518+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      2000401
    519+     copy           Uns(5)     value options(*nopass);                                                              2000402
    520+   End-PR;                                                                                                          2000403
    521+                                                                                                                    2000404
    522+   //Following constants used by json_ArrayPush:copy                                                                2000405
    523+   Dcl-C json_MOVE_UNLINK const(0);                                                                                 2000406
    524+   Dcl-C json_COPY_CLONE const(1);                                                                                  2000407
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    525+                                                                                                                    2000408
    526+   //returns the new node added to the end of                                                                       2000409
    527+   Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'jx_ArraySort');                                                 2000410
    528+     //Destination. Retrive from Locate()                                                                           2000411
    529+     pArray         Pointer    value;                                                                               2000412
    530+     //nodenames if any in subobject to comapre                                                                     2000413
    531+     pkeyNames      Pointer    value options(*string) ;                                                             2000414
    532+   End-PR;                                                                                                          2000415
    533+                                                                                                                    2000416
    534+   //returns the first node with expr value                                                                         2000417
    535+   Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'jx_lookupValue');                                             2000418
    536+     //Array/ obj to search                                                                                         2000419
    537+     pArray         Pointer    value;                                                                               2000420
    538+     //What to search for                                                                                           2000421
    539+     expr           Pointer    value options(*string);                                                              2000422
    540+     //0=(Dft) Same case, 1=ignore case                                                                             2000423
    541+     ignoreCase     Uns(5)     value options(*nopass);                                                              2000424
    542+   End-PR;                                                                                                          2000425
    543+                                                                                                                    2000426
    544+   //Following constants used by json_LookupValue:ignoreCase                                                        2000427
    545+   Dcl-C json_SAME_CASE const(0);                                                                                   2000428
    546+   Dcl-C json_IGNORE_CASE const(1);                                                                                 2000429
    547+                                                                                                                    2000430
    548+   //returns numer of element in array or obj                                                                       2000431
    549+   Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'jx_getLength'  );                                               2000432
    550+     //Array to count length                                                                                        2000433
    551+     pArray         Pointer    value;                                                                               2000434
    552+   End-PR;                                                                                                          2000435
    553+                                                                                                                    2000436
    554+   //returns the new node                                                                                           2000437
    555+   Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'jx_NodeMerge');                                                     2000438
    556+     //Destination. Retrive from Locate()                                                                           2000439
    557+     pDestNode      Pointer    value;                                                                               2000440
    558+     //Source tree  Retrive from Locate()                                                                           2000441
    559+     pSourceNode    Pointer    value;                                                                               2000442
    560+     //Optional new type                                                                                            2000443
    561+     Type           Uns(5)     value options(*nopass);                                                              2000444
    562+   End-PR;                                                                                                          2000445
    563+                                                                                                                    2000446
    564+   //Following constants used by json_Merge:Type                                                                    2000447
    565+   Dcl-C json_DONTREPLACE const(0);                                                                                 2000448
    566+   Dcl-C json_REPLACE const(1);                                                                                     2000449
    567+                                                                                                                    2000450
    568+   //returns the new node                                                                                           2000451
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    569+   Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'jx_MergeObjects');                                           2000452
    570+     //Destination. Retrive from Locate()                                                                           2000453
    571+     pDestObj       Pointer    value;                                                                               2000454
    572+     //Source tree  Retrive from Locate()                                                                           2000455
    573+     pSourceObj     Pointer    value;                                                                               2000456
    574+     //JX_DONTREPLACE or json_OBJREPLACE                                                                            2000457
    575+     Type           Uns(5)     value;                                                                               2000458
    576+   End-PR;                                                                                                          2000459
    577+                                                                                                                    2000460
    578+   //returns the source node                                                                                        2000461
    579+   Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'jx_NodeMoveInto');                                         2000462
    580+     //Destination. Retrive from Locate()                                                                           2000463
    581+     pDestObj       Pointer    value;                                                                               2000464
    582+     Name           Pointer    value options(*string);                                                              2000465
    583+     //Source tree  Retrive from Locate()                                                                           2000466
    584+     pSourceObj     Pointer    value;                                                                               2000467
    585+   End-PR;                                                                                                          2000468
    586+                                                                                                                    2000469
    587+   Dcl-PR json_Dump  extproc(*CWIDEN : 'jx_Dump');                                                  I               2000470
    588+     //Pointer to tree                                                                                              2000471
    589+     pNode          Pointer    value;                                                               I               2000472
    590+   End-PR;                                                                                                          2000473
    591+                                                                                                                    2000474
    592+                                                                                                                    2000475
    593+   Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'jx_CloneFormat');                                    I               2000476
    594+     //Pointer to tree to receive format                                                                            2000477
    595+     pNode          Pointer    value;                                                               I               2000478
    596+     //node ptr or path with right formating                                                                        2000479
    597+     pCloneFrom     Pointer    value options(*string);                                              I               2000480
    598+   End-PR;                                                                                                          2000481
    599+                                                                                                                    2000482
    600+   //**  JSON renderes ***                                                                                          2000483
    601+   Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                I               2000484
    602+     //node. Retrive from Locate()                                                                                  2000485
    603+     pNode          Pointer    value;                                                               I               2000486
    604+     //Name of output stream file                                                                                   2000487
    605+     FileName       Pointer    value options(*string);                                              I               2000488
    606+     //Ccsid of output file                                                                                         2000489
    607+     Ccsid          Int(10)    value;                                                               I               2000490
    608+     Trim           Ind        value;                                                                               2000491
    609+     //Extra options                                                                                                2000492
    610+     Options        Pointer    value options(*string:*nopass);                                      I               2000493
    611+   End-PR;                                                                                                          2000494
    612+                                                                                                                    2000495
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    613+   Dcl-PR json_AsJsonText Varchar(32767)                                                                            2000496
    614+                        extproc(*CWIDEN : 'jx_AsJsonText');                                                         2000497
    615+     //node. Retrive from Locate()                                                                                  2000498
    616+     pNode          Pointer    value;                                                                               2000499
    617+   End-PR;                                                                                                          2000500
    618+                                                                                                                    2000501
    619+   Dcl-PR json_AsJsonTextMem Uns(10)                                                                                2000502
    620+                           extproc(*CWIDEN : 'jx_AsJsonTextMem');                                                   2000503
    621+     //node. Retrive from Locate()                                                                                  2000504
    622+     pNode          Pointer    value;                                                                               2000505
    623+     //pointer to any memory buffer                                                                                 2000506
    624+     pBuffer        Pointer    value;                                                                               2000507
    625+   End-PR;                                                                                                          2000508
    626+                                                                                                                    2000509
    627+   //**  XML  renderes ***                                                                                          2000510
    628+   Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                  I               2000511
    629+     //node. Retrive from Locate()                                                                                  2000512
    630+     pNode          Pointer    value;                                                               I               2000513
    631+     //Name of output stream file                                                                                   2000514
    632+     FileName       Pointer    value options(*string);                                              I               2000515
    633+     //Ccsid of output file                                                                                         2000516
    634+     Ccsid          Int(10)    value;                                                               I               2000517
    635+     Trim           Ind        value;                                                                               2000518
    636+     //Extra options                                                                                                2000519
    637+     Options        Pointer    value options(*string:*nopass);                                      I               2000520
    638+   End-PR;                                                                                                          2000521
    639+                                                                                                                    2000522
    640+   Dcl-PR json_AsXmlText Varchar(32767) extproc(*CWIDEN : 'jx_AsXmlText');                                          2000523
    641+     //node. Retrive from Locate()                                                                                  2000524
    642+     pNode          Pointer    value;                                                                               2000525
    643+   End-PR;                                                                                                          2000526
    644+                                                                                                                    2000527
    645+   Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'jx_AsXmlTextMem');                                           2000528
    646+     //node. Retrive from Locate()                                                                                  2000529
    647+     pNode          Pointer    value;                                                                               2000530
    648+     //pointer to any memory buffer                                                                                 2000531
    649+     pBuffer        Pointer    value;                                                                               2000532
    650+   End-PR;                                                                                                          2000533
    651+                                                                                                                    2000534
    652+   // Return a streamer object to be used in own serialisers                                                        2000535
    653+   Dcl-PR json_Stream pointer extproc(*CWIDEN : 'jx_Stream');                                                       2000536
    654+     //node. Retrive from Locate()                                                                                  2000537
    655+     pNode          Pointer    value;                                                                               2000538
    656+   End-PR;                                                                                                          2000539
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    657+                                                                                                                    2000540
    658+   //**  CSV  renderes ***                                                                                          2000541
    659+   Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'jx_WriteCsvStmf');                                  I               2000542
    660+     //node. Retrive from Locate()                                                                                  2000543
    661+     pNode          Pointer    value;                                                               I               2000544
    662+     //Name of output stream file                                                                                   2000545
    663+     FileName       Pointer    value options(*string);                                              I               2000546
    664+     //Ccsid of output file                                                                                         2000547
    665+     Ccsid          Int(10)    value;                                                               I               2000548
    666+     //*ON=Remove inter blanks                                                                                      2000549
    667+     Trim           Ind        value;                                                                               2000550
    668+     //Options: ';.' for separator and dec                                                                          2000551
    669+     Options        Pointer    value options(*string:*nopass);                                      I               2000552
    670+   End-PR;                                                                                                          2000553
    671+                                                                                                                    2000554
    672+                                                                                                                    2000555
    673+   Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                        2000556
    674+     Slash          Char(1);                                                                                        2000557
    675+     BackSlash      Char(1);                                                                                        2000558
    676+     Masterspace    Char(1);                                                                                        2000559
    677+     BraBeg         Char(1);                                                                                        2000560
    678+     BraEnd         Char(1);                                                                                        2000561
    679+     Blank          Char(1);                                                                                        2000562
    680+     Dot            Char(1);                                                                                        2000563
    681+     CurBeg         Char(1);                                                                                        2000564
    682+     CurEnd         Char(1);                                                                                        2000565
    683+     Apos           Char(1);                                                                                        2000566
    684+     Quot           Char(1);                                                                                        2000567
    685+   End-DS;                                                                                                          2000568
    686+                                                                                                                    2000569
    687+   //Iterators: First use the set the use forEach                                                                   2000570
    688+   Dcl-DS json_Iterator  based(prototype_only) qualified;                                                           2000571
    689+     root           Pointer;                                                                                        2000572
    690+     this           Pointer;                                                                                        2000573
    691+     isList         Ind;                                                                                            2000574
    692+     isFirst        Ind;                                                                                            2000575
    693+     isLast         Ind;                                                                                            2000576
    694+     isRecursive    Ind;                                                                                            2000577
    695+     comma          Varchar(1);                                                                                     2000578
    696+     count          Int(10);                                                                                        2000579
    697+     length         Int(10);                                                                                        2000580
    698+     size           Int(10);                                                                                        2000581
    699+     //Pointer to temp array of elms                                                                                2000582
    700+     listArr        Pointer;                                                                                        2000583
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    701+     //Set  this to *ON to teminate loop                                                                            2000584
    702+     break          Ind;                                                                                            2000585
    703+     filler         Char(64);                                                                                       2000586
    704+   End-DS;                                                                                                          2000587
    705+                                                                                                                    2000588
    706+   Dcl-PR json_setIterator  likeds( json_Iterator)                                                                  2000589
    707+                          extproc(*CWIDEN : 'jx_SetIterator');                                                      2000590
    708+     //node. Retrive from Locate()                                                                                  2000591
    709+     pNode          Pointer    value;                                                                               2000592
    710+     //Optional - path to node                                                                                      2000593
    711+     path           Pointer    value options(*string:*nopass);                                                      2000594
    712+   End-PR;                                                                                                          2000595
    713+                                                                                                                    2000596
    714+   Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                         2000597
    715+                                   extproc(*CWIDEN :                                                                2000598
    716+                                   'jx_SetRecursiveIterator');                                                      2000599
    717+     //node. Retrive from Locate()                                                                                  2000600
    718+     pNode          Pointer    value;                                                                               2000601
    719+     //Optional - path to node                                                                                      2000602
    720+     path           Pointer    value options(*string:*nopass);                                                      2000603
    721+   End-PR;                                                                                                          2000604
    722+                                                                                                                    2000605
    723+   //Iterator Structure                                                                                             2000606
    724+   Dcl-PR json_forEach Ind extproc(*CWIDEN : 'jx_ForEach');                                                         2000607
    725+     iterator                  likeds( json_Iterator);                                                              2000608
    726+   End-PR;                                                                                                          2000609
    727+                                                                                                                    2000610
    728+   //For XML attributes                                                                                             2000611
    729+   Dcl-PR json_GetNodeAttrValue Varchar(32767)                                                      I               2000612
    730+                              extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                           2000613
    731+     //Pointer to exsiting element                                                                                  2000614
    732+     pNode          Pointer    value;                                                                               2000615
    733+     //Attribute Name                                                                                               2000616
    734+     AttrName       Pointer    value options(*string);                                              I               2000617
    735+     //If not found - default value                                                                                 2000618
    736+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000619
    737+   End-PR;                                                                                                          2000620
    738+                                                                                                                    2000621
    739+   Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'jx_SetNodeAttrValue');                                           2000622
    740+     //Pointer to exsiting element                                                                                  2000623
    741+     pNode          Pointer    value;                                                                               2000624
    742+     //Attribute name                                                                                               2000625
    743+     AttrName       Pointer    value options(*string);                                                              2000626
    744+     //New value                                                                                                    2000627
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    745+     Value          Pointer    value options(*string);                                                              2000628
    746+   End-PR;                                                                                                          2000629
    747+                                                                                                                    2000630
    748+   Dcl-PR json_GetAttrValue Varchar(32767)                                                          I               2000631
    749+                          extproc(*CWIDEN : 'jx_GetAttrValueVC');                                                   2000632
    750+     //Pointer Attribute                                                                                            2000633
    751+     pAttr          Pointer    value;                                                               I               2000634
    752+     //If not found - default value                                                                                 2000635
    753+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000636
    754+   End-PR;                                                                                                          2000637
    755+                                                                                                                    2000638
    756+   Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'jx_SetAttrValue');                                                   2000639
    757+     //Pointer Attribute                                                                                            2000640
    758+     pAttr          Pointer    value;                                                               I               2000641
    759+     //New value                                                                                                    2000642
    760+     Value          Pointer    value options(*string);                                                              2000643
    761+   End-PR;                                                                                                          2000644
    762+                                                                                                                    2000645
    763+   //Returns pointer to attribute list                                                                              2000646
    764+   Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'jx_GetAttrFirst');                           I               2000647
    765+     //Pointer to element                                                                                           2000648
    766+     pElem          Pointer    value;                                                               I               2000649
    767+   End-PR;                                                                                                          2000650
    768+                                                                                                                    2000651
    769+   //Returns pointer to attribute list                                                                              2000652
    770+   Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'jx_GetAttrNext');                             I               2000653
    771+     //Pointer to attribute list                                                                                    2000654
    772+     pAttr          Pointer    value;                                                               I               2000655
    773+   End-PR;                                                                                                          2000656
    774+                                                                                                                    2000657
    775+   Dcl-PR json_GetAttrName Varchar(32767)                                                                           2000658
    776+                         extproc(*CWIDEN : 'jx_GetAttrNameVC');                                                     2000659
    777+     //Pointer to attribute list                                                                                    2000660
    778+     pAttr          Pointer    value;                                                               I               2000661
    779+   End-PR;                                                                                                          2000662
    780+                                                                                                                    2000663
    781+ // Close all nodes in this tree - also parent and siblings                                                         2000664
    782+   Dcl-PR json_Close  extproc(*CWIDEN : 'jx_Close');                                                I               2000665
    783+     //Pointer to tree node                                                                                         2000666
    784+     pNode          Pointer  ;                                                                      I               2000667
    785+   End-PR;                                                                                                          2000668
    786+ // Detect if you have a memry leak: call this when you have closed everything at i will return                     2000669
    787+   Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'jx_MemLeak');                                         I               2000670
    788+   End-PR;                                                                                                          2000671
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    789+                                                                                                                    2000672
    790+ // Print memory report                                                                                             2000673
    791+   Dcl-PR json_MemStat  extproc(*CWIDEN : 'jx_MemStat');                                            I               2000674
    792+   End-PR;                                                                                                          2000675
    793+                                                                                                                    2000676
    794+ // Return a memory segment pointer, and build a scope where JSON/XML will be created                               2000677
    795+   Dcl-PR json_SegmentSelectNo Pointer                                                              I               2000678
    796+                             extproc(*CWIDEN : 'jx_SegmentSelectNo');                                               2000679
    797+     SegmentIndex   Int(10)    value;                                                                               2000680
    798+   End-PR;                                                                                                          2000681
    799+                                                                                                                    2000682
    800+ //  Delete the segment and all JSON/XML nodes build while segment scope was active                                 2000683
    801+   Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'jx_SegmentDispose');                              I               2000684
    802+     segmentPtr     Pointer    value;                                                                               2000685
    803+   End-PR;                                                                                                          2000686
    804+                                                                                                                    2000687
    805+ // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                     2000688
    806+   //Returns *ON if found                                                                                           2000689
    807+   Dcl-PR json_mapIx Ind extproc(*CWIDEN:'jx_MapIx' );                                              I               2000690
    808+     //pointer to node pointer                                                                                      2000691
    809+     ppNode         Pointer;                                                                        I               2000692
    810+     //index of pointer                                                                                             2000693
    811+     Index          Uns(10)    value;                                                               I               2000694
    812+   End-PR;                                                                                                          2000695
    813+                                                                                                                    2000696
    814+   //------------------------------------------------------------------------                                       2000697
    815+   //SQL interface:                                                                                                 2000698
    816+   //Note: When SQL functions returns *NULL, then use  the json_Message() to re                                     2000699
    817+   //------------------------------------------------------------------------                                       2000700
    818+                                                                                                                    2000701
    819+ // If options need - then it has to be first call made.                                                            2000702
    820+ // NOTE: If a pConnection pointer is provided, it will be updated with the conection                               2000703
    821+   Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'jx_sqlSetOptions');                                 I               2000704
    822+     //json object with options ( see sample)                                                                       2000705
    823+     parms          Pointer    value options(*string:*nopass);                                      I               2000706
    824+   End-PR;                                                                                                          2000707
    825+                                                                                                                    2000708
    826+ // returns a object node with one resulting row for the SQL statment                                               2000709
    827+   //Returns one SQL row as jx Obejct                                                                               2000710
    828+   Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'jx_sqlResultRow');                            I               2000711
    829+     //SQL statement to run                                                                                         2000712
    830+     sqlStmt        Pointer    value options(*string);                                              I               2000713
    831+     //json object template                                                                                         2000714
    832+     parms          Pointer    value options(*string:*nopass);                                      I               2000715
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    833+   End-PR;                                                                                                          2000716
    834+                                                                                                                    2000717
    835+ // returns an array (or object with array) of resulting rows for the SQL statment                                  2000718
    836+   //Returns SQL rows as jx Obejct                                                                                  2000719
    837+   Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'jx_sqlResultSet');                            I               2000720
    838+     //SQL statement to run                                                                                         2000721
    839+     sqlStmt        Pointer    value options(*string);                                              I               2000722
    840+     //From row; 1=First                                                                                            2000723
    841+     start          Int(10)    value options(*nopass);                                              I               2000724
    842+     //max number of rows; json_ALLROWS=all                                                                         2000725
    843+     limit          Int(10)    value options(*nopass);                                              I               2000726
    844+     //resultset format:                                                                                            2000727
    845+     format         Int(10)    value options(*nopass);                                              I               2000728
    846+     //json object template                                                                                         2000729
    847+     parms          Pointer    value options(*string:*nopass);                                      I               2000730
    848+   End-PR;                                                                                                          2000731
    849+                                                                                                                    2000732
    850+                                                                                                                    2000733
    851+   Dcl-C json_ALLROWS const(-1);                                                                                    2000734
    852+                                                                                                                    2000735
    853+   //Following constants used by json_sqlResultSet:format                                                           2000736
    854+   //+ An array with each row as an object                                                                          2000737
    855+   Dcl-C json_ROWARRAY const(0);                                                                                    2000738
    856+   //+ Metaobject: rows, fields                                                                                     2000739
    857+   Dcl-C json_META    const(1);                                                                                     2000740
    858+   //+ Columns info                                                                                                 2000741
    859+   Dcl-C json_FIELDS  const(2);                                                                                     2000742
    860+   //+ Count all rows in the resultset                                                                              2000743
    861+   //                ( Pricy so awoid it !! )                                                                       2000744
    862+   Dcl-C json_TOTALROWS const(4);                                                                                   2000745
    863+   //+ Uppercase column names                                                                                       2000746
    864+   Dcl-C json_UPPERCASE const(8);                                                                                   2000747
    865+                                                                                                                    2000748
    866+ // SQL cursor processing                                                                                           2000749
    867+   //Returns handle to sql statement                                                                                2000750
    868+   Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'jx_sqlOpen'  );                                     I               2000751
    869+     //SQL statement to run                                                                                         2000752
    870+     sqlStmt        Pointer    value options(*string);                                              I               2000753
    871+     //json object template                                                                                         2000754
    872+     parms          Pointer    value options(*string:*nopass);                                      I               2000755
    873+   End-PR;                                                                                                          2000756
    874+                                                                                                                    2000757
    875+ // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                                  2000758
    876+   //Returns a row object (or *NULL if EOF)                                                                         2000759
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    877+   Dcl-PR json_sqlFetchRelative Pointer                                                             I               2000760
    878+                              extproc(*CWIDEN: 'jx_sqlFetchRelative');                                              2000761
    879+     //sql statement handle ( from sqlOpen)                                                                         2000762
    880+     pSqlHndl       Pointer    value;                                                               I               2000763
    881+     //row from where to start 1=First                                                                              2000764
    882+     fromRow        Int(10)    value;                                                               I               2000765
    883+   End-PR;                                                                                                          2000766
    884+                                                                                                                    2000767
    885+ // Fetch next from from that open sql handle                                                                       2000768
    886+   //Returns a row object (or *NULL if EOF)                                                                         2000769
    887+   Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'jx_sqlFetchNext');                             I               2000770
    888+     //sql statement handle ( from sqlOpen)                                                                         2000771
    889+     pSqlHndl       Pointer    value;                                                               I               2000772
    890+   End-PR;                                                                                                          2000773
    891+                                                                                                                    2000774
    892+ // Number of columns in result set ( -1 if error)                                                                  2000775
    893+   //Returns number of columns                                                                                      2000776
    894+   Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'jx_sqlColumns');                                 I               2000777
    895+     //sql statement handle ( from sqlOpen)                                                                         2000778
    896+     pSqlHndl       Pointer    value;                                                               I               2000779
    897+   End-PR;                                                                                                          2000780
    898+                                                                                                                    2000781
    899+ // Number of rows  in result set ( -1 if error)                                                                    2000782
    900+ // Note: This will run a hidden "select count(*)" which might be a little pricy                                    2000783
    901+   //Returns number of rows                                                                                         2000784
    902+   Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'jx_sqlRows');                                       I               2000785
    903+     //sql statement handle ( from sqlOpen)                                                                         2000786
    904+     pSqlHndl       Pointer    value;                                                               I               2000787
    905+   End-PR;                                                                                                          2000788
    906+                                                                                                                    2000789
    907+ // Always colse the cursor after use, to release resources                                                         2000790
    908+   Dcl-PR json_sqlClose  extproc(*CWIDEN:'jx_sqlClose');                                            I               2000791
    909+     //sql statement handle ( from sqlOpen)                                                                         2000792
    910+     pSqlHndl       Pointer;                                                                        I               2000793
    911+   End-PR;                                                                                                          2000794
    912+                                                                                                                    2000795
    913+ // Execute any SQL statement not involving a cursor                                                                2000796
    914+   //Returns *ON if error                                                                                           2000797
    915+   Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'jx_sqlExec'  );                                         I               2000798
    916+     //SQL statement to run (template)                                                                              2000799
    917+     sqlStmt        Pointer    value options(*string);                                              I               2000800
    918+     //json object template data                                                                                    2000801
    919+     parms          Pointer    value options(*string:*nopass);                                      I               2000802
    920+   End-PR;                                                                                                          2000803
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    921+                                                                                                                    2000804
    922+ // Execute an update table where the row is defined as a json object                                               2000805
    923+   //Returns *ON if error                                                                                           2000806
    924+   Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'jx_sqlUpdate');                                       I               2000807
    925+     //table name                                                                                                   2000808
    926+     table          Pointer    value options(*string);                                              I               2000809
    927+     //json object: æa:123,b:"value"å                                                                               2000810
    928+     row            Pointer    value options(*string);                                              I               2000811
    929+     //where clause : 'where myKey=Åkey'                                                                            2000812
    930+     where          Pointer    value options(*string:*nopass);                                      I               2000813
    931+     //where parameters: æ key:777å                                                                                 2000814
    932+     whereParms     Pointer    value options(*string:*nopass);                                      I               2000815
    933+   End-PR;                                                                                                          2000816
    934+                                                                                                                    2000817
    935+   //Returns *ON if error                                                                                           2000818
    936+   Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'jx_sqlInsert');                                       I               2000819
    937+     //table name                                                                                                   2000820
    938+     table          Pointer    value options(*string);                                              I               2000821
    939+     //json object: æa:123,b:"value"å                                                                               2000822
    940+     row            Pointer    value options(*string);                                              I               2000823
    941+     //extra parms                                                                                                  2000824
    942+     parms          Pointer    value options(*string:*nopass);                                      I               2000825
    943+   End-PR;                                                                                                          2000826
    944+                                                                                                                    2000827
    945+   //Returns *ON if error                                                                                           2000828
    946+   Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'jx_sqlUpsert');                                       I               2000829
    947+     //table name                                                                                                   2000830
    948+     table          Pointer    value options(*string);                                              I               2000831
    949+     //json object: æa:123,b:"value"å                                                                               2000832
    950+     row            Pointer    value options(*string);                                              I               2000833
    951+     //where clause : 'where myKey=Åkey'                                                                            2000834
    952+     where          Pointer    value options(*string:*nopass);                                      I               2000835
    953+     //where parameters: æ key:777å                                                                                 2000836
    954+     whereParms     Pointer    value options(*string:*nopass);                                      I               2000837
    955+   End-PR;                                                                                                          2000838
    956+                                                                                                                    2000839
    957+   //Returns id of last insert                                                                                      2000840
    958+   Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'jx_sqlGetInsertId');                         I               2000841
    959+   End-PR;                                                                                                          2000842
    960+                                                                                                                    2000843
    961+   //Returns array of column info                                                                                   2000844
    962+   Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'jx_sqlGetMeta');                                 I               2000845
    963+     sqlstmt        Pointer    value options(*string);                                                              2000846
    964+   End-PR;                                                                                                          2000847
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    965+                                                                                                                    2000848
    966+ // Return pointer to database connection. No options => will be default local database                             2000849
    967+   Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'jx_sqlConnect');                                I               2000850
    968+     //json object or string with options                                                                           2000851
    969+     parms          Pointer    value options(*string:*nopass);                                      I               2000852
    970+   End-PR;                                                                                                          2000853
    971+                                                                                                                    2000854
    972+ // Return pointer to database connection. No options => will be default local database                             2000855
    973+   Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'jx_sqlDisconnect');                                 I               2000856
    974+   End-PR;                                                                                                          2000857
    975+                                                                                                                    2000858
    976+ // Return sql code for previous statement                                                                          2000859
    977+   Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'jx_sqlCode');                                      I               2000860
    978+   End-PR;                                                                                                          2000861
    979+                                                                                                                    2000862
    980+ // -------------------------------------------------------------------------------------------                     2000863
    981+ // Depricated and renamed functions :                                                                              2000864
    982+ // -------------------------------------------------------------------------------------------                     2000865
    983+ // Depricated - use  json_GetValueStr                                                                              2000866
    984+   Dcl-PR json_GetValue Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                          I               2000867
    985+     //Pointer to node                                                                                              2000868
    986+     pNode          Pointer    value;                                                               I               2000869
    987+     //If not found - default value                                                                                 2000870
    988+     Expression     Pointer    value options(*string:*nopass);                                      I               2000871
    989+     //If not found - default value                                                                                 2000872
    990+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000873
    991+   End-PR;                                                                                                          2000874
    992+                                                                                                                    2000875
    993+ // Depricated - use  json_NodeCopy                                                                                 2000876
    994+   Dcl-PR json_Copy extproc(*CWIDEN : 'jx_NodeCopy');                                                               2000877
    995+     //element. Retrive from Locate()                                                                               2000878
    996+     pRootNode      Pointer    value;                                                                               2000879
    997+     //element. Retrive from Locate()                                                                               2000880
    998+     pNewChild      Pointer    value;                                                                               2000881
    999+     //Reference location to where it arrive                                                                        2000882
   1000+     RefLocation    Int(10)    value;                                                                               2000883
   1001+   End-PR;                                                                                                          2000884
   1002+                                                                                                                    2000885
   1003+   Dcl-PR json_ElementCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                        2000886
   1004+     //element. Retrive from Locate()                                                                               2000887
   1005+     pRootNode      Pointer    value;                                                                               2000888
   1006+     //element. Retrive from Locate()                                                                               2000889
   1007+     pNewChild      Pointer    value;                                                                               2000890
   1008+     //Reference location to where it arrive                                                                        2000891
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1009+     RefLocation    Int(10)    value;                                                                               2000892
   1010+   End-PR;                                                                                                          2000893
   1011+                                                                                                                    2000894
   1012+ // Depricated - use  json_NodeDelete                                                                               2000895
   1013+   Dcl-PR json_Delete extproc(*CWIDEN : 'jx_NodeDelete');                                                           2000896
   1014+     //element. Retrive from Locate()                                                                               2000897
   1015+     pRootNode      Pointer    value;                                                                               2000898
   1016+   End-PR;                                                                                                          2000899
   1017+                                                                                                                    2000900
   1018+ // Depricated - use  json_NodeDelete                                                                               2000901
   1019+   Dcl-PR json_ElementDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                    2000902
   1020+     //element. Retrive from Locate()                                                                               2000903
   1021+     pRootNode      Pointer    value;                                                                               2000904
   1022+   End-PR;                                                                                                          2000905
   1023+                                                                                                                    2000906
   1024+ // Depricated - use  json_AsJsonText                                                                               2000907
   1025+   Dcl-PR json_AsText Varchar(32767) extproc(*CWIDEN : 'jx_AsJsonText');                                            2000908
   1026+     //element. Retrive from Locate()                                                                               2000909
   1027+     pNode          Pointer    value;                                                                               2000910
   1028+   End-PR;                                                                                                          2000911
   1029+                                                                                                                    2000912
   1030+                                                                                                                    2000913
   1031+ // json_XpathValue   is depricated and replaced by: json_GetStr                                                    2000914
   1032+   Dcl-PR json_XpathValue Varchar(32767)                                                                            2000915
   1033+                        extproc(*CWIDEN : 'jx_GetValueVC');                                                         2000916
   1034+     //Pointer to tree                                                                                              2000917
   1035+     pNode          Pointer    value;                                                                               2000918
   1036+     //Locations expression to node                                                                                 2000919
   1037+     Expression     Pointer    value options(*string);                                                              2000920
   1038+     //If not found - default value                                                                                 2000921
   1039+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      2000922
   1040+   End-PR;                                                                                                          2000923
   1041+                                                                                                                    2000924
   1042+ // json_XpathValueNum   is depricated and replaced by: json_GetNum                                                 2000925
   1043+   Dcl-PR json_XpathValueNum Packed(30:15)                                                                          2000926
   1044+                           extproc(*CWIDEN : 'jx_GetValueNum');                                                     2000927
   1045+     //Pointer to tree                                                                                              2000928
   1046+     pJsonCom       Pointer    value;                                                                               2000929
   1047+     //X-path locations to node or attributes                                                                       2000930
   1048+     Node           Pointer    value options(*string);                                                              2000931
   1049+     //If not found - default value                                                                                 2000932
   1050+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           2000933
   1051+   End-PR;                                                                                                          2000934
   1052+                                                                                                                    2000935
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1053+ // Use - json_NodeType                                                                                             2000936
   1054+   Dcl-PR json_ElementType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                              I               2000937
   1055+     //Pointer to tree to receive format                                                                            2000938
   1056+     pNode          Pointer    value;                                                               I               2000939
   1057+   End-PR;                                                                                                          2000940
   1058+                                                                                                                    2000941
   1059+ // Use json_NodeAdd                                                                                                2000942
   1060+   //returns the new element                                                                                        2000943
   1061+   Dcl-PR json_ElementAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                  2000944
   1062+     //element. Retrive from Locate()                                                                               2000945
   1063+     pRootNode      Pointer    value;                                                                               2000946
   1064+     //Reference location to where it arrive                                                                        2000947
   1065+     RefLocation    Int(10)    value;                                                                               2000948
   1066+     //Name of element                                                                                              2000949
   1067+     Name           Pointer    value options(*string);                                              I               2000950
   1068+     //Value of element                                                                                             2000951
   1069+     Value          Pointer    value options(*string);                                              I               2000952
   1070+   End-PR;                                                                                                          2000953
   1071+                                                                                                                    2000954
   1072+ // Use json_GetNext                                                                                                2000955
   1073+   //Returns pointer to next sibling (elem)                                                                         2000956
   1074+   Dcl-PR json_GetElemNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                             I               2000957
   1075+     //Pointer to current element (elem)                                                                            2000958
   1076+     pElem          Pointer    value  ;                                                             I               2000959
   1077+   End-PR;                                                                                                          2000960
   1078+                                                                                                                    2000961
   1079+ // use json_GetChild                                                                                               2000962
   1080+   //Returns pointer to next child (elem)                                                                           2000963
   1081+   Dcl-PR json_GetElemChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                           I               2000964
   1082+     //Pointer to current element (elem)                                                                            2000965
   1083+     pElem          Pointer    value;                                                               I               2000966
   1084+   End-PR;                                                                                                          2000967
   1085+                                                                                                                    2000968
   1086+                                                                                                                    2000969
   1087+ // use get json_GetName                                                                                            2000970
   1088+   Dcl-PR json_getElemName Varchar(32767)                                                           I               2000971
   1089+                         extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                     2000972
   1090+     //Pointer to node                                                                                              2000973
   1091+     pNode          Pointer    value;                                                               I               2000974
   1092+   End-PR;                                                                                                          2000975
   1093+                                                                                                                    2000976
   1094+ // use xml_GetValueStr                                                                                             2000977
   1095+   Dcl-PR json_GetElemValue Varchar(32767)                                                          I               2000978
   1096+                          extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                   2000979
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1097+     //Pointer to element                                                                                           2000980
   1098+     pElem          Pointer    value;                                                               I               2000981
   1099+     //If not found - default value                                                                                 2000982
   1100+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000983
   1101+   End-PR;                                                                                                          2000984
   1102+                                                                                                                    2000985
   1103+  // use json_GetAttrValue                                                                                          2000986
   1104+   Dcl-PR json_GetAttr Varchar(32767)                                                               I               2000987
   1105+                     extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                                    2000988
   1106+     //Pointer to element                                                                                           2000989
   1107+     pNode          Pointer    value;                                                               I               2000990
   1108+     //Attribute Name                                                                                               2000991
   1109+     AttrName       Pointer    value options(*string);                                              I               2000992
   1110+     //If not found - default value                                                                                 2000993
   1111+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000994
   1112+   End-PR;                                                                                                          2000995
   1113+                                                                                                                    2000996
   1114+ // has no effect any longer                                                                                        2000997
   1115+   //Set input and output CCSID                                                                                     2000998
   1116+   Dcl-PR json_setCcsid  extproc(*CWIDEN : 'jx_SetCcsid');                                                          2000999
   1117+     //Ccsid of inpur file                                                                                          2001000
   1118+     inputCCSID     Int(10)    value;                                                               I               2001001
   1119+     //Ccsid of output file                                                                                         2001002
   1120+     outputCCSID    Int(10)    value;                                                               I               2001003
   1121+   End-PR;                                                                                                          2001004
   1122+                                                                                                                    2001005
   1123+ // depricated - use setNum                                                                                         2001006
   1124+   Dcl-PR json_SetDec Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  2001007
   1125+     //Pointer to json_ tree                                                                                        2001008
   1126+     pNode          Pointer    value;                                                                               2001009
   1127+     //X-path locations to node or attributes                                                                       2001010
   1128+     Expresion      Pointer    value options(*string);                                                              2001011
   1129+     //New value to set / pointer to object                                                                         2001012
   1130+     Value          Packed(30:15) value;                                                                            2001013
   1131+   End-PR;                                                                                                          2001014
   1132+                                                                                                                    2001015
   1133+ // Depricated in both JSON and XML - use  json_WriteJsonStmf /   json_WriteXmlStmf                                 2001016
   1134+ /if not defined(JSONXML_DEPRICATED)                                                                                2001017
   1135+ /define  JSONXML_DEPRICATED                                                                                        2001018
   1136+   Dcl-PR json_WriteStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                    I               2001019
   1137+     //element. Retrive from Locate()                                                                               2001020
   1138+     pNode          Pointer    value;                                                               I               2001021
   1139+     //Name of output stream file                                                                                   2001022
   1140+     FileName       Pointer    value options(*string);                                              I               2001023
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1141+     //Ccsid of output file                                                                                         2001024
   1142+     Ccsid          Int(10)    value;                                                               I               2001025
   1143+     Trim           Ind        value options(*nopass);                                                              2001026
   1144+   End-PR;                                                                                                          2001027
   1145+                                                                                                                    2001028
   1146+   Dcl-PR xml_WriteStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                      I               2001029
   1147+     //element. Retrive from Locate()                                                                               2001030
   1148+     pNode          Pointer    value;                                                               I               2001031
   1149+     //Name of output stream file                                                                                   2001032
   1150+     FileName       Pointer    value options(*string);                                              I               2001033
   1151+     //Ccsid of output file                                                                                         2001034
   1152+     Ccsid          Int(10)    value;                                                               I               2001035
   1153+     Trim           Ind        value options(*nopass);                                                              2001036
   1154+   End-PR;                                                                                                          2001037
   1155+ /endif                                                                                                             2001038
   1156                                                                                                                      000015
   1157                                                                                                                      000016
   1158    // -----------------------------------------------------------------------------                                  000017
   1159    // Main                                                                                                           000018
   1160    // -----------------------------------------------------------------------------                                  000019
   1161    dcl-proc main;                                                                                                    000020
   1162                                                                                                                      000021
   1163        dcl-ds config likeds(configDS);                                                                               000022
   1164                                                                                                                      000023
   1165        config.port = 44003;                                                                                          000024
   1166        config.host = '*ANY';                                                                                         000025
   1167                                                                                                                      000026
   1168        il_listen (config : %paddr(myservlet));                                                                       000027
   1169                                                                                                                      000028
   1170    end-proc;                                                                                                         000029
   1171    // -----------------------------------------------------------------------------                                  000030
   1172    // Servlet call back implementation                                                                               000031
   1173    // -----------------------------------------------------------------------------                                  000032
   1174    dcl-proc myservlet;                                                                                               000033
   1175                                                                                                                      000034
   1176        dcl-pi *n;                                                                                                    000035
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1177            request  likeds(REQUESTDS);                                                                               000036
   1178            response likeds(RESPONSEDS);                                                                              000037
   1179        end-pi;                                                                                                       000038
   1180                                                                                                                      000039
   1181        dcl-s pOutput   pointer;                                                                                      000040
   1182                                                                                                                      000041
   1183        response.contentType = 'application/json';                                                                    000042
   1184                                                                                                                      000043
   1185        pOutput = json_sqlResultSet(' -                                                                               000044
   1186            select * from qiws.QCUSTCDT    -                                                                          000045
   1187        ');                                                                                                           000046
   1188                                                                                                                      000047
   1189        il_responseWriteStream(response : json_stream(pOutput));                                                      000048
   1190                                                                                                                      000049
   1191        json_delete(pOutput);                                                                                         000050
   1192                                                                                                                      000051
   1193                                                                                                                      000052
   1194    end-proc;                                                                                                         000053
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     31
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv Number Seq     Message text
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                             / C o p y   M e m b e r s
 Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
 Number Id              Library    File       Member            Date     Time
     13    1 ILEastic.+ ./.././headers/ILEastic.rpgle     1208  06-09-18 00:41:25
    118    2 JSONparse+ /prj/noxdb/./headers/JSONparser+   819  06-09-18 01:28:02
          * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     32
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          No references in the source.
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          CONFIGDS          DS(4166)               19D     94    1163
                            BASED(PROTOTYPE+)
 *RNF7031   FILLER          A(4096)                22D
 *RNF7031   HOST            A(64)                  20D
                            VARYING(2)
 *RNF7031   PORT            I(10,0)                21D
 *RNF7031 IL_GETFILEEXTENSION...
                            A(256)                 88D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 IL_GETFILEMIMETYPE...
                            A(256)                 83D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTHEADERS...
                            A(524284)              77D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTMETHOD...
                            A(256)                 52D
                            VARYING(2)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTPROTOCOL...
                            A(256)                 72D
                            VARYING(2)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTQUERYSTRING...
                            A(524284)              67D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     33
 *RNF7031 IL_GETREQUESTRESOURCE...
                            A(524284)              62D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTURL  A(524284)              57D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
          IL_LISTEN         PROTOTYPE              93D   1168M
 *RNF7031 IL_RESPONSEWRITE  PROTOTYPE              98D
 *RNF7031 IL_RESPONSEWRITEBIN...
                            PROTOTYPE             103D
          IL_RESPONSEWRITESTREAM...
                            PROTOTYPE             113D   1189M
 *RNF7031 IL_SERVESTATIC    N(1)                  108D
                            PROTOTYPE
 *RNF7031 JSON_AFTER_SIBLING...
                            CONST                 468D
 *RNF7031 JSON_ALLOW_PRIMITIVES...
                            CONST                 178D
 *RNF7031 JSON_ALLROWS      CONST                 851D
 *RNF7031 JSON_ARRAY        CONST                 161D
 *RNF7031 JSON_ARRAYPUSH    *(16)                 513D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSORT    *(16)                 527D
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXT   A(32767)              613D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXTMEM...
                            U(10,0)               619D
                            PROTOTYPE
 *RNF7031 JSON_ASTEXT       A(32767)             1025D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXT    A(32767)              640D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXTMEM U(10,0)               645D
                            PROTOTYPE
 *RNF7031 JSON_BEFORE_SIBLING...
                            CONST                 467D
 *RNF7031 JSON_BY_CONTEXT   CONST                 170D
 *RNF7031 JSON_CHILD_LIST   CONST                 198D
 *RNF7031 JSON_CLONEFORMAT  PROTOTYPE             593D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     34
 *RNF7031 JSON_CLOSE        PROTOTYPE             782D
 *RNF7031 JSON_COPY         PROTOTYPE             994D
 *RNF7031 JSON_COPY_CLONE   CONST                 524D
          JSON_DELETE       PROTOTYPE            1013D   1191M
 *RNF7031 JSON_DELIMITERDS  DS(11)                673D
                            BASED(PROTOTYPE+)
 *RNF7031   APOS            A(1)                  683D
 *RNF7031   BACKSLASH       A(1)                  675D
 *RNF7031   BLANK           A(1)                  679D
 *RNF7031   BRABEG          A(1)                  677D
 *RNF7031   BRAEND          A(1)                  678D
 *RNF7031   CURBEG          A(1)                  681D
 *RNF7031   CUREND          A(1)                  682D
 *RNF7031   DOT             A(1)                  680D
 *RNF7031   MASTERSPACE     A(1)                  676D
 *RNF7031   QUOT            A(1)                  684D
 *RNF7031   SLASH           A(1)                  674D
 *RNF7031 JSON_DELIMITERS   CONST                 154D
 *RNF7031 JSON_DONTREPLACE  CONST                 565D
 *RNF7031 JSON_DUMP         PROTOTYPE             587D
 *RNF7031 JSON_ELEMENTADD   *(16)                1061D
                            PROTOTYPE
 *RNF7031 JSON_ELEMENTCOPY  PROTOTYPE            1003D
 *RNF7031 JSON_ELEMENTDELETE...
                            PROTOTYPE            1019D
 *RNF7031 JSON_ELEMENTTYPE  I(5,0)               1054D
                            PROTOTYPE
 *RNF7031 JSON_ERROR        N(1)                  226D
                            PROTOTYPE
 *RNF7031 JSON_EVAL         CONST                 162D
 *RNF7031 JSON_FIELDS       CONST                 859D
 *RNF7031 JSON_FIRST_CHILD  CONST                 465D
 *RNF7031 JSON_FOREACH      N(1)                  724D
                            PROTOTYPE
 *RNF7031 JSON_GETATTR      A(32767)             1104D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRFIRST *(16)                 764D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNAME  A(32767)              775D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNEXT  *(16)                 770D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRVALUE A(32767)              748D
                            VARYING(2)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     35
                            PROTOTYPE
 *RNF7031 JSON_GETCHILD     *(16)                 299D
                            PROTOTYPE
 *RNF7031 JSON_GETDELIMITERS...
                            *(16)                 146D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMCHILD *(16)                1081D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNAME  A(32767)             1088D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNEXT  *(16)                1074D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMVALUE A(32767)             1095D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETILOBVALUE N(1)                  446D
                            PROTOTYPE
 *RNF7031 JSON_GETLENGTH    I(10,0)               549D
                            PROTOTYPE
 *RNF7031 JSON_GETNAME      A(32767)              389D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNAMEASPATH...
                            A(32767)              395D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNEXT      *(16)                 293D
                            PROTOTYPE
 *RNF7031 JSON_GETNODEATTRVALUE...
                            A(32767)              729D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNUM       P(30,15)              435D
                            PROTOTYPE
 *RNF7031 JSON_GETPARENT    *(16)                 305D
                            PROTOTYPE
 *RNF7031 JSON_GETSTR       A(32767)              412D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETSTRJOIN   A(32767)              422D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUE     A(32767)              984D
                            VARYING(2)
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     36
 *RNF7031 JSON_GETVALUENUM  P(30,15)              374D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEPTR  *(16)                 382D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUESTR  A(32767)              366D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_HAS          N(1)                  255D
                            PROTOTYPE
 *RNF7031 JSON_IGNORE_CASE  CONST                 546D
 *RNF7031 JSON_ISNODE       N(1)                  279D
                            PROTOTYPE
 *RNF7031 JSON_ISNULL       N(1)                  271D
                            PROTOTYPE
 *RNF7031 JSON_ISTRUE       N(1)                  263D
                            PROTOTYPE
          JSON_ITERATOR     DS(145)               688D    706     714     725
                            BASED(PROTOTYPE+)
 *RNF7031   BREAK           N(1)                  702D
 *RNF7031   COMMA           A(1)                  695D
                            VARYING(2)
 *RNF7031   COUNT           I(10,0)               696D
 *RNF7031   FILLER          A(64)                 703D
 *RNF7031   ISFIRST         N(1)                  692D
 *RNF7031   ISLAST          N(1)                  693D
 *RNF7031   ISLIST          N(1)                  691D
 *RNF7031   ISRECURSIVE     N(1)                  694D
 *RNF7031   LENGTH          I(10,0)               697D
 *RNF7031   LISTARR         *(16)                 700D
 *RNF7031   ROOT            *(16)                 689D
 *RNF7031   SIZE            I(10,0)               698D
 *RNF7031   THIS            *(16)                 690D
 *RNF7031 JSON_LAST_CHILD   CONST                 466D
 *RNF7031 JSON_LITERAL      CONST                 166D
 *RNF7031 JSON_LOCATE       *(16)                 238D
                            PROTOTYPE
 *RNF7031 JSON_LOCATEORCREATE...
                            *(16)                 246D
                            PROTOTYPE
 *RNF7031 JSON_LOOKUPVALUE  *(16)                 535D
                            PROTOTYPE
 *RNF7031 JSON_MAPIX        N(1)                  807D
                            PROTOTYPE
 *RNF7031 JSON_MEMLEAK      N(1)                  787D
                            PROTOTYPE
 *RNF7031 JSON_MEMSTAT      PROTOTYPE             791D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     37
 *RNF7031 JSON_MERGE        *(16)                 555D
                            PROTOTYPE
 *RNF7031 JSON_MERGEOBJECTS *(16)                 569D
                            PROTOTYPE
 *RNF7031 JSON_MESSAGE      A(1024)               232D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_META         CONST                 857D
 *RNF7031 JSON_MOVE_MODES   CONST                 176D
 *RNF7031 JSON_MOVE_UNLINK  CONST                 523D
 *RNF7031 JSON_MOVEOBJECTINTO...
                            *(16)                 579D
                            PROTOTYPE
 *RNF7031 JSON_NEWARRAY     *(16)                 507D
                            PROTOTYPE
 *RNF7031 JSON_NEWOBJECT    *(16)                 500D
                            PROTOTYPE
 *RNF7031 JSON_NODEADD      *(16)                 476D
                            PROTOTYPE
 *RNF7031 JSON_NODECLONE    *(16)                 470D
                            PROTOTYPE
 *RNF7031 JSON_NODECOPY     PROTOTYPE             455D
 *RNF7031 JSON_NODEDELETE   PROTOTYPE             489D
 *RNF7031 JSON_NODERENAME   N(1)                  285D
                            PROTOTYPE
 *RNF7031 JSON_NODESANITIZE PROTOTYPE             494D
 *RNF7031 JSON_NODETYPE     I(5,0)                404D
                            PROTOTYPE
 *RNF7031 JSON_OBJCOPY      CONST                 169D
 *RNF7031 JSON_OBJECT       CONST                 160D
 *RNF7031 JSON_OBJLINK      CONST                 167D
 *RNF7031 JSON_OBJMOVE      CONST                 171D
 *RNF7031 JSON_OBJREPLACE   CONST                 168D
 *RNF7031 JSON_PARSE        CONST                 182D
 *RNF7031 JSON_PARSEFILE    *(16)                 202D
                            PROTOTYPE
 *RNF7031 JSON_PARSESTRING  *(16)                 210D
                            PROTOTYPE
 *RNF7031 JSON_POINTER_VALUE...
                            CONST                 163D
 *RNF7031 JSON_REPLACE      CONST                 566D
 *RNF7031 JSON_ROOT         CONST                 165D
 *RNF7031 JSON_ROWARRAY     CONST                 855D
 *RNF7031 JSON_SAME_CASE    CONST                 545D
 *RNF7031 JSON_SEGMENTDISPOSE...
                            PROTOTYPE             801D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     38
 *RNF7031 JSON_SEGMENTSELECTNO...
                            *(16)                 795D
                            PROTOTYPE
 *RNF7031 JSON_SETATTRVALUE PROTOTYPE             756D
 *RNF7031 JSON_SETBOOL      *(16)                 337D
                            PROTOTYPE
 *RNF7031 JSON_SETCCSID     PROTOTYPE            1116D
 *RNF7031 JSON_SETDEC       *(16)                1124D
                            PROTOTYPE
 *RNF7031 JSON_SETDECPOINT  PROTOTYPE             218D
 *RNF7031 JSON_SETDELIMITERS...
                            PROTOTYPE             149D
 *RNF7031 JSON_SETINT       *(16)                 319D
                            PROTOTYPE
 *RNF7031 JSON_SETITERATOR  DS(145)               706D
                            PROTOTYPE
 *RNF7031 JSON_SETNODEATTRVALUE...
                            PROTOTYPE             739D
 *RNF7031 JSON_SETNUM       *(16)                 328D
                            PROTOTYPE
 *RNF7031 JSON_SETPTR       *(16)                 346D
                            PROTOTYPE
 *RNF7031 JSON_SETRECURSIVEITERATOR...
                            DS(145)               714D
                            PROTOTYPE
 *RNF7031 JSON_SETSTR       *(16)                 310D
                            PROTOTYPE
 *RNF7031 JSON_SETVALUE     *(16)                 355D
                            PROTOTYPE
 *RNF7031 JSON_SQLCLOSE     PROTOTYPE             908D
 *RNF7031 JSON_SQLCODE      I(10,0)               977D
                            PROTOTYPE
 *RNF7031 JSON_SQLCOLUMNS   I(10,0)               894D
                            PROTOTYPE
 *RNF7031 JSON_SQLCONNECT   *(16)                 967D
                            PROTOTYPE
 *RNF7031 JSON_SQLDISCONNECT...
                            PROTOTYPE             973D
 *RNF7031 JSON_SQLEXEC      N(1)                  915D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHNEXT *(16)                 887D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHRELATIVE...
                            *(16)                 877D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETINSERTID...
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     39
                            I(10,0)               958D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETMETA   *(16)                 962D
                            PROTOTYPE
 *RNF7031 JSON_SQLINSERT    N(1)                  936D
                            PROTOTYPE
 *RNF7031 JSON_SQLOPEN      *(16)                 868D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTROW *(16)                 828D
                            PROTOTYPE
          JSON_SQLRESULTSET *(16)                 837D   1185
                            PROTOTYPE
 *RNF7031 JSON_SQLROWS      I(10,0)               902D
                            PROTOTYPE
 *RNF7031 JSON_SQLSETOPTIONS...
                            PROTOTYPE             821D
 *RNF7031 JSON_SQLUPDATE    N(1)                  924D
                            PROTOTYPE
 *RNF7031 JSON_SQLUPSERT    N(1)                  946D
                            PROTOTYPE
          JSON_STREAM       *(16)                 653D   1189
                            PROTOTYPE
 *RNF7031 JSON_TOTALROWS    CONST                 862D
 *RNF7031 JSON_UNKNOWN      CONST                 159D
 *RNF7031 JSON_UPPERCASE    CONST                 864D
 *RNF7031 JSON_VALUE        CONST                 164D
 *RNF7031 JSON_WRITECSVSTMF PROTOTYPE             659D
 *RNF7031 JSON_WRITEJSONSTMF...
                            PROTOTYPE             601D
 *RNF7031 JSON_WRITESTMF    PROTOTYPE            1136D
 *RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             628D
 *RNF7031 JSON_XPATHVALUE   A(32767)             1032D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_XPATHVALUENUM...
                            P(30,15)             1043D
                            PROTOTYPE
 *RNF7031 LCOPY             A(524284)              46D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
          LVARPUCHARDS      DS(32)                 14D     27      28      29
                            BASED(PROTOTYPE+)      30      31      32      33
                                                   35      48
 *RNF7031   LENGTH          I(10,0)                15D
 *RNF7031   STRING          *(16)                  16D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     40
          MAIN              PROTOTYPE               9    1161
 *RNF7031 MO_MERGE_MATCH    CONST                 192D
 *RNF7031 MO_MERGE_NEW      CONST                 190D
 *RNF7031 MO_MERGE_REPLACE  CONST                 195D
          MYSERVLET         PROTOTYPE            1168    1174
          PROTOTYPE_ONLY    *(16)                  14      19      25      38
                                                  673     688
          REQUESTDS         DS(544)                25D     54      59      64
                            BASED(PROTOTYPE+)      69      74      79    1177
 *RNF7031   COMPLETEHEADER  DS(32)                 35D
 *RNF7031   CONTENT         DS(32)                 33D
 *RNF7031   CONTENTTYPE     A(256)                 34D
                            VARYING(2)
 *RNF7031   HEADERS         DS(32)                 32D
 *RNF7031   METHOD          DS(32)                 27D
 *RNF7031   PCONFIG         *(16)                  26D
 *RNF7031   PROTOCOL        DS(32)                 31D
 *RNF7031   QUERYSTRING     DS(32)                 30D
 *RNF7031   RESOURCE        DS(32)                 29D
 *RNF7031   URL             DS(32)                 28D
          RESPONSEDS        DS(568)                38D     99     104     109
                            BASED(PROTOTYPE+)     114    1178
 *RNF7031   CHARSET         A(32)                  43D
                            VARYING(2)
 *RNF7031   CONTENTTYPE     A(256)                 42D
                            VARYING(2)
 *RNF7031   PCONFIG         *(16)                  39D
 *RNF7031   STATUS          I(5,0)                 40D
 *RNF7031   STATUSTEXT      A(256)                 41D
                            VARYING(2)
 *RNF7031 XML_WRITESTMF     PROTOTYPE            1146D
       Field References for subprocedure MAIN
          Field             Attributes         References (D=Defined M=Modified)
          CONFIG            DS(4166)             1163D   1165M   1166M   1168
            HOST            A(64)                1166
                            VARYING(2)
            PORT            I(10,0)              1165
       Field References for subprocedure MYSERVLET
          Field             Attributes         References (D=Defined M=Modified)
          POUTPUT           *(16)                1181D   1185M   1189    1191
 *RNF7031 REQUEST           DS(544)              1177D
                            BASED(_QRNL_PST+)
          RESPONSE          DS(568)              1178D   1183M   1189
                            BASED(_QRNL_PST+)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     41
            CONTENTTYPE     A(256)               1183
                            VARYING(2)
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     42
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          jx_Has                                  255
          jx_Dump                                 587
          lvpc2lvc                                 47
          jx_Error                                226
          jx_Close                                782
          jx_MapIx                                807
          il_listen                                93    1168
          jx_IsTrue                               263
          jx_IsNull                               271
          jx_isNode                               279
          jx_Stream                               653    1189
          jx_Message                              232
          jx_GetNode                              238
          jx_NodeAdd                              476    1061
          jx_ForEach                              724
          jx_MemLeak                              787
          jx_MemStat                              791
          jx_sqlOpen                              868
          jx_sqlRows                              902
          jx_sqlExec                              915
          jx_sqlCode                              977
          jx_NodeCopy                             455     994    1003
          jx_NewArray                             507
          jx_sqlClose                             908
          jx_SetCcsid                            1116
          jx_ParseFile                            202
          jx_NodeClone                            470
          jx_NewObject                            500
          jx_ArrayPush                            513
          jx_ArraySort                            527
          jx_getLength                            549
          jx_NodeMerge                            555
          jx_AsXmlText                            640
          jx_sqlUpdate                            924
          jx_sqlInsert                            936
          jx_sqlUpsert                            946
          jx_NodeRename                           285
          jx_GetValueVC                           412     984    1033
          jx_NodeDelete                           489    1013    1019    1191
          jx_AsJsonText                           614    1025
          jx_sqlColumns                           894
          jx_sqlGetMeta                           962
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     43
          jx_sqlConnect                           967
          il_serveStatic                          108
          jx_ParseString                          210
          jx_SetDecPoint                          218
          jx_GetNodeNext                          293    1074
          jx_GetNodeType                          404    1054
          jx_GetValueNum                          435    1044
          jx_lookupValue                          535
          jx_CloneFormat                          593
          jx_SetIterator                          707
          jx_GetAttrNext                          770
          jx_GetNodeChild                         299    1081
          jx_SetStrByName                         310
          jx_SetIntByName                         319
          jx_SetDecByName                         328    1124
          jx_SetPtrByName                         346
          jx_GetStrJoinVC                         423
          jx_NodeSanitize                         494
          jx_MergeObjects                         569
          jx_NodeMoveInto                         579
          jx_WriteXmlStmf                         628    1146
          jx_AsXmlTextMem                         645
          jx_WriteCsvStmf                         659
          jx_SetAttrValue                         756
          jx_GetAttrFirst                         764
          jx_sqlResultRow                         828
          jx_sqlResultSet                         837    1187
          jx_sqlFetchNext                         887
          il_getRequestUrl                         58
          il_responseWrite                         98     103
          jx_GetDelimiters                        146
          jx_GetNodeParent                        305
          jx_SetBoolByName                        337
          jx_GetNodeNameVC                        390    1089
          ILOB_XmlGetValue                        446
          jx_WriteJsonStmf                        601    1136
          jx_AsJsonTextMem                        620
          jx_GetAttrNameVC                        776
          jx_sqlSetOptions                        821
          jx_sqlDisconnect                        973
          jx_SetDelimiters2                       149
          jx_SetValueByName                       355
          jx_GetNodeValueVC                       367    1096
          jx_GetAttrValueVC                       749
          jx_SegmentDispose                       801
          jx_sqlGetInsertId                       958
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     44
          il_getFileMimeType                       84
          jx_GetOrCreateNode                      247
          jx_GetNodeValueNum                      375
          jx_GetNodeValuePtr                      382
          jx_SegmentSelectNo                      796
          il_getRequestMethod                      53
          il_getFileExtension                      89
          jx_SetNodeAttrValue                     739
          jx_sqlFetchRelative                     878
          il_getRequestHeaders                     78
          jx_GetNodeNameAsPath                    396
          il_getRequestResource                    63
          il_getRequestProtocol                    73
          jx_GetNodeAttrValueVC                   730    1105
          il_responseWriteStream                  113    1189
          jx_SetRecursiveIterator                 716
          il_getRequestQueryString                 68
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     45
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00    249 The name or indicator is not referenced.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   06-09-18 02:42:47        Page     46
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :      249
     Warning      (10) . . . . . . . :        0
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :      249
   Source Totals:
     Records . . . . . . . . . . . . :     1194
     Specifications  . . . . . . . . :      628
     Data records  . . . . . . . . . :        0
     Comments  . . . . . . . . . . . :      382
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program DEMO03 placed in library ILEASTIC. 00 highest severity. Created on 06-09-18 at 02:42:47.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
